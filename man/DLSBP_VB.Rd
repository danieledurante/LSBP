% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/functions.R
\name{DLSBP_VB}
\alias{DLSBP_VB}
\title{Variational Bayes algorithm for the DLSBP model}
\usage{
DLSBP_VB(y, X, H = 2, maxiter = 1000, prior = NULL, tol = 1e-04,
  seed = NULL, verbose = TRUE)
}
\arguments{
\item{y}{a vector containing the response vector}

\item{X}{a n x p design matrix containing the covariates}

\item{H}{an integer indicating the number of mixture components}

\item{maxiter}{an integer indicating the maximum number of iterations for the EM algorithm}

\item{prior}{a list containing prior hyperparameters (See details for a detailed description). If not provided, the MLE is computed.}

\item{tol}{a real number controlling the convergence criterium}

\item{seed}{set the seed, for reproducibility since the initialization is random}

\item{verbose}{Logical: Should the logposterior be displayed while the algorithm is running?}
}
\value{
The output is a list containing the following quantities
\itemize{
\item \verb{mu_beta}. A (H - 1) x p matrix containing the mean of the Gaussian variational distribution of the beta coefficients.
\item \verb{Sigma_beta}. A list of p x p matrixes containing the covariance of the Gaussian variational distribution of the beta coefficients.
\item \verb{mu_tilde}. A p dimensional vector containing the means of the Gaussian variational distribution for the kernel means.
\item \verb{tau_tilde}. A p dimensional vector containing the precisions of the Gaussian variational distribution for the kernel means.
\item \verb{a_tilde}, \verb{b_tilde}. The parameters of the gamma variational distribution for the kernel precisions.
\item \verb{cluster}. A n dimensional vector containing, for each observation, the mixture component having with the highest probability.
\item \verb{z}. A n x H matrix containing the probabilities of belonging to each of the mixture components.
\item \verb{lowerbound}. The lowerbound of the DLSBP model at convergence.
}
}
\description{
The dependent logit stick-breaking process (DLSBP) model estimated through  Variational Bayes (VB).
}
\details{
The prior argument is a list which should contains the following elements
\itemize{
\item \verb{b}. A p dimensional vector containing the prior mean of the Gaussian beta coefficients
\item \verb{B}. A p x p matrix representing the prior covariance of the Gaussian beta coefficients.
\item \verb{mu_mu}. A real number representing the prior mean for the kernel means.
\item \verb{tau_mu}. A positive number representing the precision for the kernel means.
\item \verb{a_tau}, \verb{b_tau}. The hyperparameters of a gamma prior distribution for the kernel precisions.
}
}
\examples{
library(DLSBP)
data(geyser)
x <- geyser$waiting
y <- geyser$duration
X <- cbind(1,x*I(x<=68) + 68*I(x > 68),((x-68)*I(x>68))) # Predictors
p <- NCOL(X)
prior   <- list(b = rep(0,p),        
                B = diag(100,p), 
                mu_mu =0,            
                tau_mu = 0.001,     
                a_tau = 2,           
                b_tau = 0.001)
fit_VB   <- DLSBP_VB(y=y, X=X, H=3, prior=prior, seed=99)

}
\references{
Rigon, T. and Durante, D., (2017), Logit stick-breaking priors for Bayesian density regression, ArXiv.
}

